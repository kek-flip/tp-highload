# Google Translate

## Содержание

- ### [Тема, аудитория, функционал](#1-тема-аудитория-функционал)
- ### [Расчет нагрузки](#2-расчет-нагрузки)
- ### [Глобальная балансировка нагрузки](#3-глобальная-балансировка-нагрузки)

## 1 Тема, аудитория, функционал

[Google Translate](https://translate.google.com/) - онлайн-переводчик компании Google, предназначенный для перевода текстов и веб-страниц.

### Основной функционал

- Перевод текста
- Перевод текста с изображения
- Перевод web-страниц

### Аудитория

- 610 млн. пользователей в день <sup>[\[1\]](https://en.wikipedia.org/wiki/Google_Translate)</sup>
- 711,6 млн. пользователей в месяц <sup>[\[2\]](https://pro.similarweb.com/#/digitalsuite/websiteanalysis/overview/website-performance/*/999/1m?webSource=Total&key=translate.google.com)</sup>

## 2 Расчет нагрузки

Согласно Digital 2024 Global Overview Report <sup>[\[3\]](https://datareportal.com/reports/digital-2024-global-overview-report)</sup> еженедельно онлайн-переводчиками пользуются 28,1% пользователей интернета. Ссылаясь на этот же отчет, интернетом пользуется 66,2% населения, то есть 5,35 млрд. человек.  
Имеем, что еженедельно сервисами для перевода пользуются **5,35 \* 0,281 = 1,5 млрд.** человек.

Так как онлайн-переводчики не требуют авторизации, то невозможно достоверно определить DAU и MAU показатели. Помимо этого, можно сказать, что большинство людей, которые пользуются сервисами для перевода, используют их постоянно. То есть, если человек воспользовался переводчиком на этой неделе, то он скорее всего воспользуется им на следующей.

Исходя из рассуждений и расчетов выше, а также факта, что Google Translate имеет наибольшее число скачиваний в магазинах приложений (можно сказать, является самым популярным), будем считать значения аудитории из п. 1 подходящими для анализа нагрузки.

### Перевод текста

Пользователь отправляет текст и получает в ответ перевод. Средняя длина предложения 15-20 слов, средняя длина слова 2-3 слога, то есть **средняя длина** предложения с учетом пробелов равна **(15-20) \* (2-3) \* (2-3) + (14-19) = (74-199) символов** . Из полученного диапазона возьмем медиану - **137 символов**.

Положим, что в среднем пользователь переводит по 2 предложения в день.  
Тогда, исходя из дневного кол-ва пользователей, **RPS<sub>текст</sub> = 2 \* 610 млн. / 86400 = 141 тыс.** **Нагрузка** на сеть при этом будет равна **2 \* 137 \* 2 Байт \* 610 млн. / 86400 c = 0,03 Гбит/c**. **Суммарный трафик** за день - **324 ГБайт**

### Перевод с картинки

Допустим, в среднем пользователь использует перевод картинки 1 раз в неделю, тогда **RPS<sub>изображения</sub> = 0,14 \* 610 млн. / 86400 = 1008**.  
Положим средний размер изображения 1,5 МБайт. Исходя из данного размера картинки, **сетевой трафик = 0,14 \* 1,5 МБайт \* 610 млн. / 86400 с = 12 Гбит/c**, а **суммарный суточный трафик = 129600 ГБайт**.

### Перевод web-страницы

Пусть пользователь переводит одину страницу в день. Метрика RPS при этом в два раза меньше, чем у текста, то есть **RPS<sub>страница</sub> = 70,5 тыс.**  
Допустим, что текста на странице 30 КБайт. Тогда **сетевой трафик = 1,7 Гбит/c**, **сумарный суточный трафик = 18360 ГБайт**.

### Продуктовые метрики

| Метрика                        | Значение   |
| ------------------------------ | ---------- |
| Месячная аудитория             | 711,6 млн. |
| Дневная аудитория              | 610 млн.   |
| Переводов текстов в день       | 1,22 млрд. |
| Переводов с изображений в день | 85,4 млн.  |
| Переводов web-страниц в день   | 610 млн.   |

### Технические метрики

#### Запросов в секунду

Пусть пиковая нагрузка больше средней в 2,5 раза.

| Функция                      | RPS<sub>средний</sub> | RPS<sub>пиковый</sub> |
| ---------------------------- | --------------------- | --------------------- |
| Перевод текста               | 141 тыс.              | 352,5 тыс.            |
| Перевод текста с изображения | 1008                  | 2520                  |
| Перевод web-страниц          | 70,5 тыс.             | 176,25 тыс.           |

#### Сетевой трафик

| Функция                      | Среднесуточный трафик, Гбит/с | Суммарный суточный трафик, ГБайт |
| ---------------------------- | ----------------------------- | -------------------------------- |
| Перевод текста               | 0,03                          | 324                              |
| Перевод текста с изображения | 12                            | 129600                           |
| Перевод web-страниц          | 1,7                           | 18360                            |

## 3 Глобальная балансировка нагрузки

_Подробнее с расположением всех локаций можно ознакомится на Google MyMaps  
https://www.google.com/maps/d/edit?mid=1TMTIwXW3jG85r6fQezCtuEX5COACaQU&usp=sharing_

Для определения местоположения дата-центров и балансировки над ними необходимо определить, где расположены конечные пользователи переводчика.  
В основном онлайн-переводчиками пользуются

- иностранные студенты
- туристы
- иммигранты

То есть, расположение дата-центров будет зависеть от расположения данных групп людей.

Отметим скопления этих групп на карте.

**Самые популярные туристические направления<sup>[\[4\]](https://studyinternational.com/news/most-visited-countries-in-the-world/)</sup>**

![Самые популярные туристические направления](img/tourism.png)

**Самые интернациональные университеты<sup>[\[5\]](https://www.timeshighereducation.com/student/best-universities/most-international-universities-world)</sup>**

![Самые интернациональные университеты](img/internationalUniversities.png)

**Страны с наибольшим числом иммигрантов<sup>[\[6\]](https://www.un.org/en/development/desa/population/migration/data/estimates2/data/UN_MigrantStockTotal_2019.xlsx)</sup>**

![Страны с наибольшим числом иммигрантов](img/immigrants.png)

Так как для онлайн-переводчика нежелательны большие задержки, необходимо расположить дата-центры как можно ближе к целевой аудитории. Исходя из рисунков выше, а также плотности населения в тех районах, для дата-центров были выбраны следующие города:

- Берлин
- Лондон
- Рим
- Москва
- Шанхай
- Нью-Йорк
- Лос-Анджелес
- Мехико
- Дубай
- Бангкок

![Дата-центры](img/dataCenters.png)

Для балансировки нагрузки будет использоваться **BGP-anycast**, так как он лучше работает при балансировке в рамках региона. Для обработки запроса будет выбираться ближайший дата-центр.
